export default(({asserter:S,logger:y,groupStarter:u,groupEnder:p,warner:T}=((c=(e,s,i)=>{const r=e.startsWith('"')?1:0,n=[],o=[];return k(e.split('"').filter(e=>e),(e,t)=>(t+r)%2?n.push(`%c"${e}"`)&&o.push(i):n.push("%c"+e)&&o.push(s))||[n.join(""),...o]},s=(e,t,s,n,o,i=!1)=>{if(!t){t=", please double check.";if(Array.isArray(e)){const[l,...a]=e,h=a.length;let i=[],r="";k((l+t).split('"%o"'),(e,t)=>{var[e,...s]=c(e,n,o);r+=e,i=[...i,...s],t<h&&(r+='%c"%o"',i=[...i,o,a[t]])}),s(r,...i)}else s(...c(e+t,n,o));if(i)throw new Error("dagger AssertionError occurred!")}})=>({asserter:(e,t)=>s(e,t,console.assert.bind(console,!1),m.errorPlainStyle,m.errorHighlightStyle,!0),logger:e=>m.log&&console.log(...c(e,m.logPlainStyle,m.logHighlightStyle)),warner:(e,t)=>m.warning&&s(e,t,console.warn,m.warningPlainStyle,m.warningHighlightStyle),groupStarter:e=>m.log&&console.group(e),groupEnder:e=>m.log&&console.groupEnd(e)}))(),c=Symbol("context"),O=null,m={integrity:!0},o=[],h={bubble:"bubble",self:"self",mutation:"mutation"},j=!1,v=/^[_a-z]{1}[\w]*$/,B=null,z=/^(http:\/\/|https:\/\/|\/|\.\/|\.\.\/)/i,x=null,$=null,w=null,q=[],A=e=>Array.isArray(e)?e:[e],C=()=>Object.create(null),l=C(),E=new Set,N=((n=new Set,o=new Set,l=(e,t,s,i=0)=>{var r=s[i++];if(r){var n=r.$eventListenerMap&&r.$eventListenerMap[e.type],n=n?[...n].filter(e=>Object.is(e.decorators.capture,t)):[];if(!n.length)return l(e,t,s,i);Object.defineProperty(e,"currentTarget",{configurable:!0,value:r});for(const{decorators:o,handler:l}of n)if(l(e),o.stopImmediate)return e.stopImmediatePropagation();e.cancelBubble||l(e,t,s,i)}})=>(e,t,s,i)=>{t.$eventListenerMap||(t.$eventListenerMap=C());var r=t.$eventListenerMap[e]||new Set;s instanceof Function&&(s={decorators:{capture:i},handler:s}),g.call(r,s),t.$eventListenerMap[e]=r,i&&o.has(e)||!i&&n.has(e)||((i?o:n).add(e),window.addEventListener(e,e=>l(e,i,i?e.composedPath().reverse():e.composedPath(),0),i))})(),k=(t,s)=>{if(t){var i=t.length||0;for(let e=0;e<i;++e)s(t[e],e)}},t=(...e)=>{const t=C();return k(e,e=>t[e]=!0)||t},M=Symbol("meta"),P={json:"json",namespace:"namespace",script:"script",style:"style",string:"string",view:"view"},R=Promise.resolve(),L=null,V=new Set,J=document.createTextNode(""),b=((n={options:{debugDirective:!0,integrity:!1,log:!0,warning:!0,logPlainStyle:"color: #337ab7",logHighlightStyle:"color: #9442d0",warningPlainStyle:"color: #ff0000",warningHighlightStyle:"color: #b22222",errorPlainStyle:"color: #ff0000",errorHighlightStyle:"color: #b22222",rootSelectors:["title","body"]},modules:{view:{uri:["template#view"],type:P.view},script:{uri:['script[type="dagger/script"]'],type:P.script,anonymous:!0},style:{uri:['style[type="dagger/style"]'],type:P.style,scoped:!0}},routers:{mode:"hash",prefix:"",aliases:{},default:"",routing:null}},o=(e,t,s,i)=>({base:e,content:i?Object.assign({},n[s],t):t}))=>(e,t,s="modules")=>{e=_(e,`script[type="dagger/${s}"]`,!1,!0);if(e){const i=e.getAttribute("src"),r=!Object.is(s,"modules")||e.hasAttribute("extends");return e.hasAttribute("base")&&(t=new URL(e.getAttribute("base")||"",t).href),i?se(new URL(i,t),e.integrity).then(({content:e})=>o(t,I(e),s,r)):o(t,e.textContent.trim()?I(e.textContent):{},s,r)}return{base:t,content:n[s]}})(),I=t=>{if(!Reflect.has(l,t))try{try{l[t]=new Function(`return (${t});`)()}catch(e){l[t]=new Function(`return (() => {${t}})();`)()}}catch(e){S(`The content "${t}" is not legal javaScript code, parsing with error "${e.message}"`)}return l[t]},U=(()=>e=>Object.is(typeof e,"string"))(),Y=((e=t(...Object.keys(P).map(e=>"@"+e)),r=(e,t)=>{var s=Array.isArray(e),i=e;return U(e)||s&&e.every(U)?e={uri:e}:s&&(e={candidates:e}),e.candidates&&(e.candidates=A(e.candidates),s=e.candidates.find(e=>e instanceof Object&&(!Reflect.has(e,"media")||matchMedia(e.media).matches)),S(['There is no matched config candidate within "%o" for the current runtime environment',i],s),Object.assign(e,s)),e.type||(e.type=t),e.uri&&(e.uri=A(e.uri)),e})=>i=>k(Object.keys(i),s=>e[s]&&i[s]instanceof Object?k(Object.entries(i[s]),([e,t])=>{S([`The module "${e}" already exists in "%o"`,i],!Reflect.has(i,e)),i[e]=r(t,s.substring(1))})||Reflect.deleteProperty(i,s):i[s]=r(i[s]))||i)(),K=e=>Reflect.ownKeys(e).filter(e=>!Object.is(e,M)),f=async([e,...t],s={stop:!1})=>{if(!s.stop)return e instanceof Promise?e.then(e=>f([e,...t],s)):e instanceof Function?f([e(null,s),...t],s):t.length?f([t.shift()(e,s),...t],s):e},X=JSON.stringify,g=Set.prototype.add,G=Set.prototype.clear,H=Set.prototype.delete,Q=Map.prototype.clear,Z=Map.prototype.set,ee=WeakMap.prototype.set,D=()=>{o.length&&(k(I(`[${o.map(e=>e.processor).join(", ")}]`),(e,t)=>{t=o[t];l[t.processor]=e,t.processor=e}),o.length=0)},te=s=>{function e(...e){var t=O,e=(O=null,s.apply(this,e));return O=t,e}return e.prototype=s.prototype,e},_=(e,t,s=!1,i=!1)=>{try{var r=e[s?"querySelectorAll":"querySelector"](t);return i||S(`Failed to get element matched selector "${t}"`,s?r.length:r),r}catch(e){S(`The string "${t}" is not a valid querySelector`,i)}},se=(s,e="")=>fetch(s,m.integrity&&e?{integrity:"sha256-"+e}:{}).then(e=>{if(e.ok){const t=e.headers.get("content-type");return S(`Missing "content-type" for the response content of "${s}"`,t),e.text().then(e=>({content:e,type:t}))}T(`❎ Failed to fetch remote resource from "${s}"`)}).catch(()=>T(`❎ Failed to fetch remote resource from "${s}"`)),ie=(e,t,s)=>{var i=document.createElement("style");return e&&(i.textContent=e),document.head.appendChild(i),i.disabled=s,i.setAttribute("name",t),i.setAttribute("router-debug",location.href),i.setAttribute("active-debug",!s),i},re=e=>{var t=document.createElement("template");return t.innerHTML=e,t.content},ne=(e,s)=>k(e.children,t=>{Object.is(t.tagName,"TEMPLATE")?(t.getAttribute("$html")&&(t.$tags=s),ne(t.content,s)):t instanceof HTMLElement&&k(s,e=>t.setAttribute(e,""))}),d=(e,t=!0)=>{if(!U(e)){if(null==e||Number.isNaN(e))return"";if(e instanceof Object)return X(e);e=String(e)}return t?e.trim():e},F=((r=Object.prototype.hasOwnProperty,n=new Set([...Reflect.ownKeys(Symbol).map(e=>Symbol[e]).filter(e=>Object.is(typeof e,"symbol")),c,M]),o=new WeakMap,l=new Set([void 0,Array,Object]),a={get:(e,t)=>{const s=e[t];if(O&&!n.has(t)&&(Object.is(s)||r.call(e,t))){const i=O.topologySet;k([...e[M]].filter(e=>!e.parent||i.has(e)),e=>e.fetch(t,s).subscribe())}return s},set:(e,t,s)=>{var i;return S('It\'s illegal to overwrite "$router" of the rootScope',j||!Object.is(e,B)||!Object.is(t,"$router")),e[t]=s,!n.has(t)&&r.call(e,t)&&(i=e[M],O&&i.forEach(e=>e.unsubscribe(O)),s=F(e,t),i.forEach(e=>e.fetch(t).update(s,h.self))),!0},deleteProperty:(e,t)=>{var s=Reflect.has(e,t);return!!Reflect.deleteProperty(e,t)&&(s&&U(t)&&e[M].forEach(e=>e.fetch(t).update(void 0,h.self)),!0)}})=>(e,t)=>{var s,i=null==t;let r=i?e:e[t];return(r instanceof Object||r&&!r.constructor)&&((s=o.get(r))?r=s:(r[M]=new Set,l.has(r.constructor)&&(s=new Proxy(r,a),ee.call(o,r,s),k(K(r),e=>F(r,e)),r=s),ee.call(o,r,r))),i?r[M].add(new ae(null,"",r)):e[t]=r,r})(),oe=((r=new Map,i={json:"dagger/json",namespace:"dagger/modules",script:"dagger/script",style:"dagger/style",string:"dagger/string"},n=C(),o={html:"text/html",json:"application/json",script:["application/javascript","javascript/esm","text/javascript"],style:"text/css"},l=/(?:^|;|\s+)(?:export|import)\s*?(?:(?:(?:[$\w*\s{},]*)\s*from\s*?)|)(?:(?:"([^"]+)?")|(?:'([^']+)?'))[\s]*?(?:$|)/gm,e=new TextEncoder,c=((o=/([\s:+>~])/)=>(t,e,s,i)=>{var r,n;e instanceof CSSKeyframesRule&&(r=e.name,e.name=r+"-"+s,t.insertRule(e.cssText,i.index++),e.name=r),(e.cssRules||[]).length?k(e.cssRules,e=>c(t,e,s,i)):e.selectorText&&((n=(r=e.style).animationName)&&(r.animationName=n+"-"+s),t.insertRule(`${e.selectorText.split(",").map(e=>(e=e.trim())&&`${o.test(e)?e.replace(o,`[${s}]$1`):e+`[${s}]`}, [${s}] `+e).join(", ")}{${r.cssText}}`,i.index++),n)&&(r.animationName=n)})(),d=(i,r)=>{try{k(K(i),e=>{var t=i[e],s=t instanceof Function;r[e]=s?te(t):t,t instanceof Object&&!s&&d(t,t)})}catch(e){}finally{return r}},a=class{constructor(e={},t="",s="",i=null){s=s.trim(),S(`The module name should be valid string matched RegExp "${v.toString()}" instead of "${s}"`,!i||v.test(s)),this.layer=s?((i||{}).layer||0)+1:0,this.space=new Array(4*this.layer).fill(" ").join(""),this.name=s,this.state="unresolved",this.valid=!0,this.module=this.integrity=this.parent=this.children=this.type=this.content=this.resolvedContent=null,i?(this.parent=i,this.path=i.path?i.path+"."+s:s,this.tags=[...i.tags,this.path.replace(/\./g,"__")],this.baseElement=i.baseElement):(this.path=s,this.tags=["__"],this.baseElement=document);var{integrity:s,uri:r,type:n}=e;n&&(S(`${this.space}The type of module "${this.path}" should be one of "json, namespace, script, style, string, view" instead of "${n}"`,P[n]),this.type=n),Reflect.has(e,"content")?(this.content=e.content,S(`${this.space}The type of module "${this.path}" should be specified as one of "json, namespace, script, style, string, view" instead of "${n}"`,n)):r?this.URIs=r:S([`${this.space}Failed to parse the config "%o" for module "${this.path}" as there is no valid "content" or "uri" definition`,e]),this.integrity=s,this.config=e,this.promise=new Promise(e=>this.resolver=e),this.base=new URL(e.base||t,(i||{}).base||document.baseURI).href,e.prefetch&&this.resolve()}fetch(e){var t;return e.length?(t=e.shift(),this.fetchChild(t).fetch(e)):this}fetchChild(t,e=!1){var s=(this.children||[]).find(e=>Object.is(e.name,t)&&e.valid);if(s||!e)return S(this.space+`Failed to fetch module "${t}" within `+(this.path?`namespace "${this.path}"`:"the root namespace"),!Object.is(s)),s}fetchViewModule(e){var t=this.fetchChild(e,!0);return t?(S(`The module "${t.path}" is referenced but not declared in the "modules" field of the current router`,!Object.is(t.state,"unresolved")),t):(S(`There is no valid module named "${e}" found`,this.parent),this.parent.fetchViewModule(e))}resolve(e=null){const t=this.type;if(!Object.is(this.state,"unresolved")){if(!e)return this.valid&&Object.is(this.state,"resolved")&&(Object.is(t,P.style)?g.call(E,this.module):Object.is(t,P.namespace)&&k(this.children,e=>e.resolve())),this.promise;this.promise=new Promise(e=>this.resolver=e)}this.state="resolving",y(this.space+"⏳ resolving the "+(this.path?`module "${this.path}"`:"root module")),this.verifyDependency();let s=null;if(null==this.content)s=[...this.URIs.map(s=>(S([`${this.space}The "uri" of module "${this.path}" should be valid "string" instead of "%o"`,s],U(s)),(e,t)=>(t.stop=!!e)||this.resolveURI(s))),e=>{e||(S([`${this.space}Failed to resolve uri of module "${this.path}" from "%o"`,this.URIs]),this.valid=!1,this.resolved(null))}];else{const i=this.content;s=[...s=[P.namespace,P.json].includes(t)?(S([`${this.space}The content of module "${this.path}" with type "${t}" should be valid "object" instead of "%o"`,i],i&&Object.is(typeof i,"object")),[!this.path&&this.integrity||this.resolveIntegrity(i),()=>Object.is(t,P.namespace)?this.resolveNamespace(i,this.base,e):i]):[this.resolveIntegrity(i),e=>this.resolveContent(e)],e=>this.resolveModule(e),e=>this.resolved(e)]}return R.then(()=>f(s)),this.promise}resolveCachedModuleProfile(e){return this.integrity=e.integrity,this.verifyDependency(),this.type||(this.type=e.type),e.resolvedContent}resolveContent(e){U(e)||(e=X(e)),this.content=e.trim();var t=this.type;if(Object.is(t,P.namespace))return this.baseElement=re(e),f([b(this.baseElement,this.base),({base:e,content:t})=>this.resolveNamespace(t,e)]);if(Object.is(t,P.script))return import("data:text/javascript, "+encodeURIComponent(e.replace(l,(e,t,s)=>e.replace(t||s,new URL(t||s,this.base))))).catch(()=>S(`${this.space}Failed to import dynamic script module "${this.path}" with resolved content "${e}"`));if(Object.is(t,P.view)){const s=new W(re(e),this.parent,null,null,!1,{});return Promise.all(s.promises||[]).then(()=>s)}return Object.is(t,P.style)?ie(e,this.path+"-template",!0):Object.is(t,P.json)?JSON.parse(e):Object.is(t,P.string)?this.content:void S(`${this.space}Failed to resolve module "${this.path}" of unknown type "${t}"`)}resolved(e){return this.module=e,this.state="resolved",this.resolver(this),y(this.space+"✅ resolved the "+(this.path?`"${this.type}" module "${this.path}"`:"root module")),this}resolveEmbeddedType(t){if(!this.type){var{tagName:e,type:s}=t;if(Object.is(e,"TEMPLATE"))this.type=P.view;else if(Object.is(e,"STYLE")&&Object.is(s,i.style))this.type=P.style;else if(Object.is(e,"SCRIPT")){if(Object.is(s,i.namespace))return this.type=P.namespace,f([this.resolveIntegrity(t.innerHTML),e=>this.resolveNamespace(I(e),t.getAttribute("base")||this.base)]);Object.is(s,i.script)?this.type=P.script:Object.is(s,i.json)?this.type=P.json:Object.is(s,i.string)&&(this.type=P.string)}S([`The element "%o" of type "${s||"undefined"}" is not supported`,t],this.type)}return f([this.resolveIntegrity(t.innerHTML),e=>this.resolveContent(e)])}resolveIntegrity(t){return m.integrity?crypto.subtle.digest("SHA-256",e.encode(U(t)?t:X(t))).then(e=>{e=btoa([...new Uint8Array(e)].map(e=>String.fromCharCode(e)).join(""));return S(`The expected "SHA-256" integrity for module "${this.path}" is "${this.integrity}" while the computed integrity is "${e}"`,!this.integrity||Object.is(this.integrity,e)),n[e]||(n[e]=this),this.integrity=e,this.verifyDependency(),t}):t}resolveModule(e){let t=this.resolvedContent=e;var s=this.type,i=Object.is(s,P.namespace),r=Object.is(s,P.view);if(this.parent&&(i||r))try{var n=document.createElement(this.name);S([`${this.space}It's illegal to use "${this.name}" as a namespace or view module name as it's the tag name of builtin html element "%o"`,n.constructor],!Object.is(this.name,this.name.toLowerCase())||n instanceof HTMLUnknownElement)}catch(e){S(`${this.space}It's illegal to use "${this.name}" as a namespace or view module name`)}if(i)t=this.module,this.children||(this.children=e),this.config.explicit&&(this.config.anonymous?Object.assign(this.parent.module,t):this.parent.module[this.name]=t),this.parent&&this.parent.resolve().then(e=>Object.setPrototypeOf(t,e.module));else if(r)ne(t.node,this.parent.tags);else if(Object.is(s,P.script))t=d(t,C()),Object.is(this.config.anonymous,!1)?this.parent.module[this.name]=t:Object.assign(this.parent.module,t);else if(Object.is(s,P.style)){if(!Object.is(this.config.scoped,!1)){const o=ie("",this.path,!0),l=o.sheet,a={index:0},h=this.parent.path?this.parent.path.replace(/\./g,"__"):"__";k(t.sheet.cssRules,e=>c(l,e,h,a)),o.setAttribute("based",this.path+"-template"),t=o}g.call(E,t)}else Object.is(s,P.json)?this.config.anonymous?Object.assign(this.parent.module,t):this.parent.module[this.name]=t:Object.is(s,P.string)&&(this.parent.module[this.name]=t);return t}resolveNamespace(e,s,t=null){this.parent&&Y(e),this.children||(this.children=Object.entries(e).map(([e,t])=>new a(t,s,e,this)));let i=this.children;return t&&(i=this.children.filter(e=>t.has(e.name)),Object.is(i.length,t.size)||(k(i,e=>H.call(t,e.name)),S(`The modules "${[...t].join(", ")}" is not declared in the root namespace`))),this.module=this.module||C(),Promise.all(i.map(e=>e.resolve()))}resolveRemoteType(e,t,s){this.base=s,this.type||(s.endsWith(".js")||s.endsWith(".mjs")||o.script.some(e=>t.includes(e))?this.type=P.script:s.endsWith(".css")||t.includes(o.style)?this.type=P.style:s.endsWith(".html")||t.includes(o.html)?(e=e.trim(),this.type=e.startsWith("<html>")||e.startsWith("<!DOCTYPE ")?P.namespace:P.view):s.endsWith(".json")||t.includes(o.json)?this.type=P.json:this.type=P.string)}resolveURI(t){if(t=t.trim()){let e=null;if(z.test(t)){var s=n[this.integrity];if(s)e=[s.resolve(),e=>this.resolveCachedModuleProfile(e)];else{this.integrity&&(n[this.integrity]=this);const i=new URL(t,this.base).href;e=[(e,t)=>f([se(i,this.integrity),e=>e||(t.stop=!0)]),({content:e,type:t})=>this.resolveRemoteType(e,t,i)||this.resolveIntegrity(e),e=>this.resolveContent(e)]}}else{s=_(this.baseElement,t),t=r.get(s);e=t?(T([""+this.space+`❎ The module "${this.path}" and "${t.path}" reference the same embedded element "%o"`,s]),[t.resolve(),e=>this.resolveCachedModuleProfile(e)]):(Z.call(r,s,this),[this.resolveEmbeddedType(s)])}return e&&f([...e,e=>this.resolveModule(e),e=>this.resolved(e)])}}verifyDependency(){if(this.integrity&&(!this.type||Object.is(this.type,P.namespace))){let e=this.parent;for(;e;)S(`There is a circular reference between module "${this.path}" and module "${e.path}"`,!Object.is(e.integrity,this.integrity)),e=e.parent}}})=>a)(),le=((y={checked:e=>Object.is(e.tagName,"OPTION")?e.selected:e.checked,file:e=>(e.multiple?[...e.files]:e.files[0])||null,focus:e=>e.isSameNode(document.activeElement),result:((s=(t,{buffer:e,data:s,encoding:i})=>{let r={file:t,loaded:0,progress:0,state:"initialized",content:null};const n=new FileReader;return n.onloadstart=()=>(r=r&&r[M]&&[...r[M]][0].value||r).state="loading",n.onprogress=({loaded:e})=>(r.loaded=e,r.progress=Math.floor(e/t.size*100)),n.onload=()=>(r.state="loaded",r.content=n.result),n.onerror=()=>r.state="error",n.onabort=()=>r.state="abort",e?n.readAsArrayBuffer(t):s?n.readAsDataURL(t):n.readAsText(t,i||"utf-8"),r})=>(e,t)=>e.multiple?[...e.files].map(e=>s(e,t)):s(e.files[0],t))(),selected:e=>{var{name:t,type:s,tagName:i}=e,i=Object.is(i,"SELECT"),t=(S(['Please specify valid "name" attribute on input node "%o" to support "$selected" directive',e],i||t),[...i?e.selectedOptions:_(document.body,`input[type="${s}"][name="${t}"]:checked`,!0)].map(e=>r(e)));return(i?e.multiple:Object.is(s,"checkbox"))?t:t[0]},value:({type:e,value:t,valueAsNumber:s},{number:i,trim:r},{detail:n})=>n?null:["date","datetime-local"].includes(e)?new Date(s||0):["number","range"].includes(e)?s:i?Number.parseFloat(t):r?t.trim():t},o=["draggable"],h=(e,t,s,{name:i})=>t&&(null==e?t.removeAttribute(i):t.setAttribute(i,d(e))),l=((a=new Event("change"))=>{return{$boolean:(e,t,s,{name:i})=>t.toggleAttribute(i,!!e),checked:(t,s,{parentNode:i},{decorators:r})=>{var{tagName:n,type:e}=s,o=Object.is(n,"OPTION"),l=Object.is(e,"checkbox");if(o||Object.is(n,"INPUT")&&(l||Object.is(e,"radio"))){let e=null;if(o){if(Object.is(t,s.selected))return;s.selected=t;n=i;n&&(!n.multiple&&t&&(e=_(n,"option",!0)),n.$changeEvent||(n.$changeEvent=!0,N("change",n,e=>k(_(e.target,"option",!0),e=>e.dispatchEvent(a)))))}else l&&r.indeterminate&&(s.indeterminate=null==t),s.indeterminate||(s.checked=t),l||t&&(e=_(document.body,`input[type="radio"][name="${s.name}"]`,!0));e&&R.then(()=>k(e,e=>e.dispatchEvent(a)))}else h(t,s,0,{name:"checked"})},class:(t,e,{profile:{classNames:s}})=>{if(t){const i=new Set(s);Array.isArray(t)?k(t,e=>g.call(i,d(e))):t instanceof Object?k(Object.keys(t),e=>t[e]&&g.call(i,e.trim())):g.call(i,d(t)),e.setAttribute("class",[...i].join(" ").trim())}else s?e.setAttribute("class",s.join(" ")):e.removeAttribute("class")},each:((v=(t,e,s,i,r,n,o,l,a,h,c,d)=>{let u=null;var p=r.get(s);if(p){if(u=p.shift(),p.length||f.call(r,s),!Object.is(t,u.index)){var{landmark:m,upperBoundary:p}=u,v=[p];let e=p;for(;!Object.is(e,m);)e=e.nextSibling,v.push(e);k(v.reverse(),e=>d.insertBefore(e,(t?i[t-1].landmark||{}:h.upperBoundary).nextSibling)),i.includes(u)&&i.splice(u.index,1),u.index=t,i[t]=u}u.scope[l]=e,u.scope[o]=t}else u=new b(c,h,t,{[o]:t,[l]:e,[a]:s});r=n.get(s);r?r.push(u):Z.call(n,s,[u])},f=Map.prototype.delete)=>(e,t,i,{decorators:s})=>{e=e||{};const r=new Set(e.values instanceof Function?e.values():Object.values(e)),n=[...e.entries instanceof Function?e.entries():Object.entries(e)],{children:o,childrenMap:l,profile:a,parentNode:h}=i,c=e[M];if(c&&k(n,([t,s])=>s&&s[M]&&c.forEach(e=>e.fetch(t,s))),!n.length)return Q.call(l)||i.removeChildren(!0);l.forEach((e,t)=>r.has(t)||k(e,e=>e.destructor(!0))||f.call(l,t));const d=new Map,{item:u="item",key:p="key",index:m="index"}=s;T(['❎ Duplication found in slice scope schemes "%o"',{item:u,key:p,index:m}],!Object.is(p,m)&&!Object.is(p,u)&&!Object.is(u,m)),k(n,([e,t],s)=>v(s,e,t,o,l,d,m,p,u,i,a,h)),o.length=n.length,l.forEach(e=>k(e,e=>(e.parent=null,e.destructor(!0)))),i.childrenMap=d})(),exist:(e,t,s)=>e?Object.is(s.state,"unloaded")&&s.loading():s.unloading(!0),file:(e,t)=>S([`The data bound to directive "$file" of element "%o" should be "File${t.multiple?" array":""}" instead of "%o"`,t,e],!e||(t.multiple?Array.isArray(e)&&e.every(e=>e instanceof File):e instanceof File)),focus:(e,t,s,{decorators:{prevent:i=!1}})=>e?t.focus({preventScroll:i}):t.blur(),html:(e,t,s,{decorators:{root:i=!1,strict:r=!1}})=>{if(e=d(e),s.removeChildren(!0),e){!r&&v.test(e)&&(e=`<${e}></${e}>`);const n=[],o=s.profile,l=re(e);t||(r=o.node.$tags)&&ne(l,r),Reflect.construct(W,[l,i?x:o.namespace,n,null,!0]),n.length&&(D(),Promise.all(n.map(e=>Promise.all(e.promises||[]))).then(()=>k(n,(e,t)=>s.profile&&Reflect.construct(b,[e,i?null:s,t,null,(e.landmark||e.node).parentNode])))),t?t.appendChild(l):s.parentNode.insertBefore(l,s.landmark)}},result:(e,t)=>S([`The data bound to directive "$result" of element "%o" should be "object${t.multiple?" array":""}" instead of "%o"`,t,e],!e||(t.multiple?Array.isArray(e)&&e.every(e=>e instanceof Object):e instanceof Object)),selected:(l=(e,t,s)=>{const i=r(e);return s?(t||[]).some(e=>Object.is(e,i)):Object.is(t,i)},(t,e)=>{var{type:s,tagName:i}=e,r=Object.is(i,"SELECT");if(r||Object.is(i,"INPUT")&&(Object.is(s,"checkbox")||Object.is(s,"radio"))){const n=r?e.multiple:Object.is(s,"checkbox");n&&S(['The data bound to directive "$selected" of element "%o" should be "array" instead of "%o"',e,t],null==t||Array.isArray(t)),r?R.then(()=>k(_(e,"option",!0),e=>e.selected=l(e,t,n))):e.checked=l(e,t,n)}else h(t,e,0,{name:"selected"})}),style:(o=(e,t)=>{var s,i;t&&([s,i=""]=t.split(":").map(e=>e.trim()),S(`The content "${t}" is not a valid style declaration`,s&&i),e[s]=i)},(t,e,{profile:{inlineStyle:s,styles:i}})=>{if(t){const r=Object.assign({},i);Array.isArray(t)?k(t,e=>o(r,d(e))):t instanceof Object?k(Object.keys(t),e=>r[e.trim()]=d(t[e])):k(d(t).split(";"),e=>o(r,e.trim())),e.style.cssText=Object.keys(r).filter(e=>r[e]).map(e=>`${e}: ${r[e]}; `).join("").trim()}else s?e.setAttribute("style",s):e.removeAttribute("style")}),text:(e,t)=>{e=d(e),Object.is(e,t.textContent)||(t.textContent=e)},value:(n=(e,t=2)=>String(e).padStart(t,"0"),(t,s,e,{decorators:{trim:i=!1}})=>{e.value=t;var{tagName:e,type:r}=s,e=Object.is(e,"INPUT");if(S(['It\'s illegal to use directive "$value" on element "%o"',s],!(e&&Object.is(r,"file"))),e){e=["date","datetime-local"].includes(r);if(t instanceof Date)if(e||Object.is(r,"week"))s.valueAsNumber=t;else if(Object.is(r,"month"))s.value=t.getUTCFullYear()+"-"+n(t.getUTCMonth()+1);else if(Object.is(r,"time")){r=s.step||0;let e=n(t.getUTCHours())+":"+n(t.getUTCMinutes());r%60&&(e=e+":"+n(t.getUTCSeconds()),r%1)&&(e=e+"."+n(t.getUTCMilliseconds(),3)),s.value=e}else s.value=t;else t=d(t,i),e?s.valueAsNumber=new Date(t):s.value=t}else s.value=d(t,i)})};var n,o,l})(),j=(()=>(n,e,t)=>!e||(e=A(e))[t](e=>{{var t=n,s=!(e=String(e)).startsWith("!");s||(e=e.substring(1));const i=new RegExp(e),r=t.getModifierState&&t.getModifierState(e)||[t.code,t.key,t.button].some(e=>i.test(e));return s==r}}))(),s=(s,t,i)=>t&&k(t.filter((e,t)=>e&&(e.index=t,e.decorators)&&s.includes(e.decorators.name)).reverse(),e=>i(e)||t.splice(e.index,1)),i=({target:e,event:t,handler:s,options:i,listener:r})=>r?H.call(e.$eventListenerMap[t],r):e.removeEventListener(t,s,i),r=e=>(e&&Reflect.has(e[c]||{},"value")?e[c]:e).value,b=class{constructor(s,e=null,i=0,t=null,r=null){const{directives:n,dynamic:o,namespace:l,node:a,landmark:h,plain:c,text:d,html:u,raw:p}=s;if(this.directives=n,this.profile=s,this.index=i,this.state="loaded",this.parent=this.children=this.childrenMap=this.existController=this.landmark=this.upperBoundary=this.childrenController=this.controller=this.controllers=this.eventHandlers=this.scope=this.sentry=this.node=null,e?(this.parent=e,this.parentNode=r||e.node||e.parentNode,this.scope=e.scope,e.children.splice(i,0,this)):(this.parentNode=a.parentNode||h.parentNode,this.scope=$),this.module=l.module,u)return this.loading();if(p||c)this.resolveNode(),this.node.removeAttribute&&this.node.removeAttribute("dg-cloak"),c&&this.resolveChildren();else if(d)this.resolveNode(()=>this.controller=this.resolveController(d));else{r=(this.directives||{}).each;if((r||s.virtual)&&this.resolveLandmark(t),t){const{plain:c,root:m}=r.decorators;this.sliceScope=this.resolveScope(t,c,m),e.children.length>i+1&&k(e.children,(e,t)=>e&&i<t&&e.index++)}else if(s.slotScope&&(this.slotScope=this.resolveScope(Object.assign({},s.slotScope),!0)),r)return this.children=[],this.childrenMap=new Map,this.controller=this.resolveController(r),this;if(o){const v=o.processor(this.module,this.scope,this.parentNode),n=this.directives;this.directives=Object.assign({},n,{controllers:[...n.controllers||[]],eventHandlers:[...n.eventHandlers||[]]}),k(A(v),e=>{U(e)&&(e=(t=e.indexOf("="))<0?{name:e,value:""}:{name:e.substring(0,t),value:e.substring(t+1)}),S(['The name of "@directive" expression should be "string" instead of "%o"',e.name],U(e.name)),S(['The value of "@directive" expression should be "string" instead of "%o"',e.value],U(e.value));var t=e.name.trim();S([`It's illegal to create "@raw", "@directive" or "$each" directive with the "@directive" expression "%o"`,v],!t.startsWith("@raw")&&!t.startsWith("@directive")&&!t.startsWith("$each")),s.resolveDirective(t,e.value,this.directives)}),D()}e=(this.directives||{}).exist;e?(this.lanmark||this.resolveLandmark(t),this.state="unloaded",this.existController=this.resolveController(e)):this.loading()}}destructor(e){this.unloading(e);var{plain:t,text:s}=this.profile;t||s||(e&&(this.landmark&&this.landmark.remove(),this.upperBoundary)&&this.upperBoundary.remove(),this.existController&&this.removeController(this.existController),t=(this.parent||{}).children,e&&t&&(k(t,(e,t)=>t>this.index&&e.index--),t.splice(this.index,1))),k(Reflect.ownKeys(this),e=>{this[e]=null})}initialize(){var{html:e,virtual:t}=this.profile,t=(e?this.node=e:t||this.resolveNode(),(this.directives||{}).loaded);this.resolvePromise(t&&t.processor(this.module,this.scope,this.node),()=>this.postLoaded()),e||this.resolveChildren()}loading(){this.state="loading";const i=(this.directives||{}).loading;i?this.resolvePromise(i.processor(this.module,this.scope,null),e=>{var t,s;Object.is(this.state,"loading")&&(e&&(t=e.constructor,Object.is(t,Object)||!t&&Object.is(typeof e,"object"))&&({root:t,plain:s}=i.decorators,this.resolveScope(e,s,t)),this.initialize())}):this.initialize()}postLoaded(){var e,t,s;this.state="loaded",this.node&&this.node.removeAttribute("dg-cloak"),w?(w(this.scope),w=null):this.directives&&({controllers:e,eventHandlers:t,sentry:s}=this.directives,s&&(this.sentry=Object.assign({},s,{owner:this,processor:s.processor.bind(null,this.module,this.scope)}),g.call(V,this.sentry)),t&&(this.eventHandlers=t.map(({event:e,decorators:t={},processor:s,name:i})=>{const{capture:r,outside:n,once:o,passive:l,target:a}=t,h=a?window[a]||_(document,a):this.node,c=n?window:h,d=e=>this.updateEventHandler(e,i,s.bind(null,this.module,this.scope),t,h);var u;return S([`The target of "+${e}" directive declared on element "%o" is invalid`,this.node||this.profile.node],h),o||l?(u={capture:r,once:o,passive:l},c.addEventListener(e,d,u),{target:c,event:e,handler:d,options:u}):(u={decorators:t,handler:d},N(e,c,u,r),{target:c,event:e,listener:u})})),e)&&(this.controllers=e.map(e=>this.resolveController(e)).filter(e=>e))}removeChildren(e){if(e)if(this.node)this.node.innerHTML="";else if(this.upperBoundary){let e=this.upperBoundary.nextSibling;for(;e&&!Object.is(e,this.landmark);){var t=e.nextSibling;e.remove(),e=t}}(this.children||[]).length&&(k(this.children,e=>e&&e.destructor(!1)),this.children.length=0)}removeController(t){t.topologySet.forEach(e=>e.unsubscribe(t)),G.call(t.topologySet),t.observer&&t.observer.disconnect(),Object.is(t,this.childrenController)&&(this.childrenController=null),Object.is(t,this.existController)&&(this.existController=null)}removeDirectives(e,t){e&&(t=A(t),s(t,[...this.controllers,this.childrenController,this.existController],e=>this.removeController(e)),s(t,this.eventHandlers,i))}resolveChildren(){var e=this.profile.children,t=(this.directives||{}).child;!this.children&&(e||t&&Object.is(t.name,"html"))&&(this.children=[]),t?this.childrenController=this.resolveController(t):k(e,(e,t)=>new b(e,this,t))}resolveController({name:e,decorators:t={},processor:s}){const i=this.node,r=!t.once||t.lazy,n={name:e,owner:this,decorators:t,processor:s.bind(null,this.module,this.scope),topologySet:r?new Set:null,observer:null,updater:e&&(l[e]||i&&!o.includes(e)&&Object.is(typeof i[e],"boolean")&&l.$boolean||h)};return r&&i&&Object.is(e,"selected")&&Object.is(i.tagName,"SELECT")&&(n.observer=new MutationObserver(()=>this.updateController(n,!0))).observe(i,{childList:!0}),this.updateController(n,!0),r&&n}resolveLandmark(t){var{index:s,parent:i,parentNode:r,profile:{landmark:n,virtual:e}}=this;if(i){let e=null;s=i.children[s+1];e=s?s.upperBoundary||s.node||s.landmark:t?i.landmark:r.contains(n||null)?n:i.node?null:i.landmark,this.landmark=r.insertBefore(J.cloneNode(!1),e)}else this.landmark=n;(e||(this.directives||{}).each)&&(this.upperBoundary=r.insertBefore(J.cloneNode(!1),this.landmark))}resolveNode(e){var{node:t,unique:s,raw:i}=this.profile,s=s?t:t.cloneNode(i);(this.node=s)[c]=this,e&&e(),s.isConnected||(t=this.landmark||this.parent&&(this.parent.node?null:this.parent.landmark),this.parentNode.insertBefore(s,t&&Object.is(this.parentNode,t.parentNode)?t:null))}resolvePromise(e,t){e instanceof Promise?e.then(t):t(e)}resolveScope(e,t,s){return t||(e=F(e)),this.scope=Object.setPrototypeOf(e,s?$:this.scope),e}unloading(e){if(!Object.is(this.state,"unloaded")){if(!this.controller||this.removeController(this.controller)||(this.controller=null),!this.profile.text){if(this.state="unloading",this.profile.plain||this.childrenMap)return this.removeChildren(e);this.childrenController&&this.removeController(this.childrenController),k(this.controllers,e=>this.removeController(e))||(this.controllers=null),k(this.eventHandlers,i)||(this.eventHandlers=null)||this.node&&(this.node.$eventListenerMap=null),this.sentry&&(H.call(V,this.sentry),this.sentry=null);var t=(this.directives||{}).unloading,t=(t&&t.processor(this.module,this.scope,this.node),this.node),t=(e&&t&&t.remove(),this.node=null,this.removeChildren(e),this.scope=this.sliceScope||(this.parent||{}).scope||$,(this.directives||{}).unloaded);t&&t.processor(this.module,this.scope,null)}this.state="unloaded"}}updateEventHandler(e,t,s,i,r){if(!t){var{on:n,inside:o,outside:l,every:a,some:h,prevent:c,stop:d,stopImmediate:u}=i,{type:p,target:m,currentTarget:v}=e,f=Object.is(m,v);if(T([`❎ Please avoid using "on", "inside" or "outside" decorators together on "+${p}" directive on element "%o".`,v],!!n+!!o+!!l<2),!((!(n||o||l)||l&&r.contains&&!r.contains(m)||n&&f||o&&(!v.contains||v.contains(m)&&!f))&&j(e,a,"every")&&j(e,h,"some")))return;c&&e.preventDefault(),d&&e.stopPropagation(),u&&e.stopImmediatePropagation()}const b=O,g=i.remove;O=null;p=s(this.node,t?y[t](this.node,i,e):e);g&&(p instanceof Promise?p.then(e=>this.removeDirectives(e,g)):this.removeDirectives(p,g)),O=b}})=>{var n,a;return b.prototype.updateController=(n=new Set,a=(t,s,e)=>{if(t.profile){const{decorators:{once:r,remove:n,router:o,lazy:l},topologySet:a,updater:h,name:c}=s,d=!r||l;var i;(e||a&&[...a].some(e=>!Object.is(e.oldValue,e.value)))&&(a&&a.size&&(a.forEach(e=>e.unsubscribe(s)),G.call(a)),e=O,O=d?s:null,i=s.processor(t.node),d&&o&&L.subscribe(),O=e,l&&!c?(s.processor=i,s.decorators.lazy=!1):i instanceof Promise?i.then(e=>(n&&t.removeDirectives(e,n),h&&h(e,t.node,t,s))):(n&&t.removeDirectives(i,n),h&&h(i,t.node,t,s)))}},function(e,t){n.has(e)||(g.call(n,e),R.then(()=>{H.call(n,e),a(this,e,t)}))}),b})(),W=((v={$:"controller","+":"event"},f=t("checked","file","focus","result","selected","value"),b=t("loading","loaded","sentry","unloading","unloaded"),j=t("STYLE","SCRIPT"),O=e=>e.includes("__")?e.replace(/__[a-z]/g,e=>e[2].toUpperCase()):e,g=(e,t,s,i)=>e.eventHandlers.push(w(`Object.is(${t}, _$data_) || (${t} = _$data_)`,Object.assign({event:i},s),"$node, _$data_")),$=(e,t,s="")=>{m.debugDirective&&e.setAttribute(`${v[t[0]]||"meta"}-${decodeURIComponent(t.substring(1)).trim().replace(/\#/g,"__").replace(/:/g,"_").replace(/[^\w]/g,"-")}-debug`,s)},w=((n="$module, $scope")=>(e,t={},s="$node")=>{var{clear:i,debug:r}=t.decorators||{},s=(e=(s?`(${n}, ${s})`:`(${n})`)+` => { with ($module) with ($scope) return (() => { 'use strict';
 ${r?"debugger;\n\r":""}${i?"console.clear();\n\r":""}return ${e}; })(); }`,l[e]),r=Object.assign({},t,{processor:s||e});return s||o.push(r),r})(),s=class{constructor(e,t=x,s=null,i=null,r=!1,n=null){this.node=e,this.namespace=t,this.unique=r,this.defaultSlotScope=n||(i||{}).defaultSlotScope||null,this.dynamic=this.plain=this.raw=this.virtual=!1,this.text=this.inlineStyle=this.styles=this.directives=this.landmark=this.children=this.classNames=this.html=this.slotScope=null;r=e.nodeType;if(Object.is(r,Node.TEXT_NODE)){var n=e.textContent.trim();n&&(n.includes("${")&&n.includes("}")?(s&&s.push(this),this.text=w(`\`${n}\``,{name:"text"},""),this.promises=[],this.node=this.resolveLandmark(e,"string template replaced")):this.raw=!0,i.children.push(this))}else if(Object.is(r,Node.ELEMENT_NODE)){this.promises=[];const o="dg-cloak",{attributes:l,tagName:a}=e,h="@raw",c=l[h];if(this.html=e.isSameNode(document.documentElement)&&e,this.raw=!(!c&&!j[a]),this.raw)c&&($(e,h),e.removeAttribute(h)),s&&e.removeAttribute(o);else{const d=[],u=[],p={controllers:d,eventHandlers:u},m=O(a.toLowerCase()),v=Object.is(e.constructor,HTMLUnknownElement)&&t.fetchViewModule(m.split(".")[0]),f=Object.is(v.state,"resolved"),b="@directive",g=l[b],y="@slot";if(v&&S(`It is illegal to use "$html" or "$text" directive on view module "${m}"`,!e.hasAttribute("$html")&&!e.hasAttribute("$text")),(v||Object.is(m,"template"))&&(this.virtual=!0,this.resolveLandmark(e,"virtual node removed")),v&&!f)this.resolveDirective("$html",`\`${e.outerHTML.replace(/`/g,"\\`").replace(/\${/g,"\\${")}\``,p),this.directives=p;else{if(e.hasAttribute(y)&&(t="_$slot_"+(n=e.getAttribute(y).trim()),$(e,y,n),e.removeAttribute(y),this.defaultSlotScope)&&(this.defaultSlotScope[t]=e.innerHTML,T([`❎ Please avoid adding "$html" or "$text" directive on element "%o" as it's declared "@slot" meta directive already`,e],!e.hasAttribute("$html")&&!e.hasAttribute("$text")),e.removeAttribute("$html"),e.removeAttribute("$text"),this.resolveDirective("$html#strict",t,p)),k([...l],({name:e,value:t})=>this.resolveDirective(e,t,p)),g?(this.directives=p,this.dynamic=w(g.value),e.removeAttribute(b)):(d.length||(p.controllers=null),u.length||(p.eventHandlers=null),(p.controllers||p.eventHandlers||2<Object.values(p).length)&&(this.directives=p)),this.html)return D();this.plain=!(this.directives||this.landmark)}s&&(this.plain?e.hasAttribute(o)&&k(e.children,e=>e.setAttribute(o,""))||e.removeAttribute(o):s.push(this)&&(s=null)),v?f&&this.resolveViewModule(v.fetch(m.split(".").slice(1))):p.child||this.resolveChildren(e,s)}i&&(i.children.push(this),this.promises.length)&&i.promises.push(Promise.all(this.promises))}else Object.is(r,Node.DOCUMENT_FRAGMENT_NODE)?(this.promises=[],this.resolveChildren(e,s)):Object.is(r,Node.COMMENT_NODE)?this.raw=!0:S(`The node type "${r}" is not supported`)}resolveChildren(e,t){e=(this.virtual?e.content:e).childNodes;return e.length?(this.children=[],k(e,e=>Reflect.construct(s,[e,this.namespace,t,this,!!this.unique])),this.plain&&this.children.every(e=>e.raw)&&(this.raw=!0,this.plain=!1)):this.plain&&(this.raw=!0,this.plain=!1),this.raw&&(this.children=null),this}resolveDirective(e,t,s){var i=v[e[0]];if(i){var r=this.node;$(r,e,t),r.removeAttribute(e);const[h,...c]=O(e.substring(1)).split("#"),d=C(),u={decorators:d};if(k(c.filter(e=>e),t=>{var[e,s]=t.split(":").map(e=>decodeURIComponent(e).trim());if(s)if(["every","some"].includes(e))try{d[e]=JSON.parse(s)}catch(e){S([`Failed to resolve the directive decorator "${t}" for element "%o", the decorator value should be valid "JSON string"`,this.node])}else d[e]=s;else d[e]=e}),Object.is(i,"event"))u.event=h,b[h]?s[h]=w(t,u,Object.is(h,"sentry")?"$nextRouter":"$node"):s.eventHandlers.push(w(t,u,"$node, $event"));else{e=Object.is(h,"watch"),i=(e||(u.name=h),e&&d.lazy&&(t=`${t.substring(t.indexOf("(")+1,t.lastIndexOf(")")).trim()||"null"}, $node => `+t),w(t,u));if(Object.is(h,"each"))S(['It is illegal to use "$each" directive with "id" attribute together on node "%o"',r],!r.hasAttribute("id")),s.each=i,this.resolveLandmark(r,'"$each" node replaced'),this.unique=!1;else if(Object.is(h,"exist"))s.exist=i,this.resolveLandmark(r,'"$exist" node replaced'),this.unique=!1;else if(Object.is(h,"html")||Object.is(h,"text"))T(['❎ Please avoid adding "$html" and "$text" directives together on element "%o"',r],!s.child),s.child=i;else{if(Object.is(h,"class"))this.classNames||r.classList.length&&(this.classNames=[...r.classList].map(e=>e.trim()));else if(Object.is(h,"style")){if(!this.styles){const p=r.style,m=[...p];m.length&&(this.inlineStyle=r.getAttribute("style"),this.styles=C(),k(m,e=>{var t=p[e],s=p.getPropertyPriority(e);this.styles[e]=s?t+" !"+s:t}))}}else if(f[h]){var n,o,l,a,e=Object.is(h,"value");if(d.oneway||(d.capture=!0,{tagName:r,type:a}=r,n=Object.is(h,"checked"),o=Object.is(h,"selected"),l=Object.is(a,"checkbox")||Object.is(a,"radio"),a=Object.is(a,"file"),Object.is(h,"focus")?(g(s,t,u,"blur"),g(s,t,u,"focus")):(Object.is(r,"INPUT")&&(a&&(Object.is(h,"file")||Object.is(h,"result"))||l&&(n||o)||!l&&!a&&e)||Object.is(r,"OPTION")&&n||Object.is(r,"SELECT")&&o||Object.is(r,"TEXTAREA")&&e)&&g(s,t,u,d.input?"input":"change")),e)return s.controllers.unshift(i)}s.controllers.push(i)}}}}resolveLandmark(e,t){if(!this.landmark)return this.landmark=J.cloneNode(!1),this.promises.push(R.then(()=>e.replaceWith(this.landmark)||t)),this.landmark}resolveViewModule(e){var t=e.module,t=t instanceof s?t:e.fetchChild("view").module;if(S(`"${e.path}" or "${e.path}.view" is not a valid view module`,t instanceof s),this.children=t.children,this.defaultSlotScope=t.defaultSlotScope,Object.keys(this.defaultSlotScope).length){const i={},r="_$slot_",n="@slot";k(this.node.children,e=>{var t,s;e.hasAttribute(n)&&(t=e.getAttribute(n).trim(),s=r+t,$(e,n,t),e.removeAttribute(n),i[s]=Object.is(e.tagName,"TEMPLATE")?e.innerHTML:e.outerHTML)}),Reflect.has(this.defaultSlotScope,r)&&!Reflect.has(i,r)&&this.node.innerHTML&&(i[r]=this.node.innerHTML),this.slotScope=Object.assign({},this.defaultSlotScope,i)}}})=>s)(),ae=class{constructor(e,t,s){this.value=this.oldValue=s,this.parent=null,this.controllerSet=new Set,this.children=C(),this.name=t,e&&((e.children[t]=this).parent=e)}dispatch(e=h.bubble){S('It is illegal to modify fields under "$router" of the rootScope',j||!Object.is(L,this.parent)),Object.is(e,h.mutation)||this.parent&&this.parent.parent&&this.parent.dispatch(h.bubble);const t=Object.is(e,h.bubble);this.value&&this.value[M]?this.value[M].forEach(e=>e.trigger(t)):this.trigger(t)}fetch(e,t){e=this.children[e]||new ae(this,e,t);return t&&t[M]&&g.call(t[M],e),e}subscribe(){var e;return O&&(g.call(O.topologySet,this),g.call(this.controllerSet,O),e=this.parent)&&e.parent&&e.unsubscribe(O),this}trigger(t){this.controllerSet.size?this.controllerSet.forEach(e=>e.owner.updateController(e,t))||R.then(()=>this.oldValue=this.value):this.oldValue=this.value}unsubscribe(e){H.call(e.topologySet,this),H.call(this.controllerSet,e)}update(t,e){var s=this.value;Object.is(s,t)||(s instanceof Object&&Reflect.has(s,M)&&H.call(s[M],this),t instanceof Object&&Reflect.has(t,M)&&g.call(t[M],this),this.value=t,this.dispatch(e),Object.is(t)&&this.parent&&(Reflect.deleteProperty(this.parent.children,this.name),this.parent=null),k(K(this.children),e=>this.children[e].update((t||C())[e],h.mutation)))}})=>ie("[dg-cloak] { display: none !important; }","dg-global-style",!1)&&document.addEventListener("DOMContentLoaded",()=>Promise.all(["options","modules","routers"].map(e=>b(document,document.baseURI,e))).then(((l="",f=history.pushState,t=history.replaceState,b=null,g=null,i={"":E},r=(e,t=null)=>{try{var s=document.getElementById(e)||_(document,`a[name=${e}]`,!1,!0);if(s)return t&&t.preventDefault(),s.scrollIntoView(),location.href.endsWith("#@"+e)||f.call(history,null,"",location.href+"#@"+e),!0}catch(e){}},a=((v=((s=e=>{p(`resolving modules of the router "${e.path||"/"}"`),y(`✅ router has changed from "${($.$router||{}).path||"/"}" to "${e.path||"/"}"`),D();var t=$.$router&&i[$.$router.path];j=!0,$.$router=e,j=!1,L||(L=[...e[M]][0],q.map(e=>new le(e))),Object.is(t,E)||(t&&t.forEach(e=>(e.disabled=!E.has(e),e.setAttribute("active-debug",!e.disabled))),E.forEach(e=>(e.disabled=!1,e.setAttribute("active-debug",!0)))),r(e.anchor)})=>e=>{y(`⏳ router is changing from "${($.$router||{}).path||"/"}" to "${e.path||"/"}"...`);var t=e.path;return E=i[t]||(i[t]=new Set),u(`resolving modules of the router "${e.path}"`),x.resolve(e.modules).then(()=>s(e))})())=>()=>{var e=location.hash.lastIndexOf("#@"),e=0<=e?location.hash.substring(e+2):"";let t=(Object.is(g.mode,"history")?""+location.pathname+location.search:location.hash.replace(e,"")).replace(g.prefix,"");t.startsWith("/")||(t="/"+t);var{mode:s,aliases:i,prefix:r}=g,[n="",o=""]=t.split("?"),l=n.substring(1),a={},n=Object.is(n,"/")?[""]:n.split("/"),h=[];let c=null;if(Reflect.has(i,l)?(c=i[l],y("🦘 router alias matched")):b.match(h,a,n)?(h.reverse(),c=(h.find(e=>e.redirectPath||Object.is(e.redirectPath,""))||{}).redirectPath):Reflect.has(g,"default")?(S(`The router "${l}" is invalid`,!Object.is(g.default,l)),T(`❎ The router "${l}" is invalid`),c=g.default):S(`The router "${l}" is invalid`),null!=c)return y(`The router is redirecting from "${l}" to "${c}"`),history.replaceState(null,"",""+(o?c+"?"+o:c)+e||g.prefix);const d={},u=Object.assign({},...h.map(e=>e.variables)),p=Object.assign({},...h.map(e=>e.constants)),m=(o&&k([...new URLSearchParams(o)],([e,t])=>d[e]=t),k(Object.keys(u),e=>{if(Reflect.has(d,e)&&!Reflect.has(p,e)){var t=typeof u[e],s=d[e];try{u[e]=Object.is(t,"string")?s:window[""+t[0].toUpperCase()+t.substring(1)](JSON.parse(s))}catch(e){S(`The expected variable type is "${t}" but the real queryString content is "${s}"`)}}}),{url:location.href,mode:s,prefix:r,path:l,paths:n,modules:new Set(h.map(e=>e.modules).flat()),query:o,queries:d,scenarios:a,variables:u,constants:p,anchor:e});y(`⏳ resolving sentries within router "${($.$router||{}).path||"/"}"...`),Promise.all([...V].map(t=>Promise.resolve(t.processor(m)).then(e=>({sentry:t,prevent:e})))).then(e=>{y(`✅ resolved sentries within router "${($.$router||{}).path||"/"}"`);e=e.filter(e=>e.prevent).map(e=>e.sentry.owner);e.length?k(e,e=>T(['❎ The router redirect is prevented by the "$sentry" directive declared on the "%o" element',e.node||e.profile.node]))||f.call(history,null,"",$.$router.url):v(m)})})(),c=class{constructor(e,t=null){var{children:s,constants:i={},variables:r={},modules:n=[],tailable:o=!1,redirect:l=""}=e,a=(this.layer=t?t.layer+1:0,new Array(4*this.layer).fill(" ").join(""));let h=(e.path||"").trim();this.modules=A(n),S([`${a}The "modules" field of router should be either "string" or "string array" matched RegExp "${v.toString()}" instead of "%o"`,n],this.modules.every(e=>U(e)&&v.test(e))),t?(h&&!Object.is(h,"*")||(h=".+"),this.path=t.path+"/"+h):(T(a+'❎ The "path" field of the root router will be ignored',!Reflect.has(e,"path")),h="",this.path=""),y(a+"⏳ resolving the "+(this.path?`router with path "${this.path}"`:"root router")),l&&(this.redirectPath=l instanceof Function?l($,x.module):I(`($module, $scope) => { with ($module) with ($scope) return (() => { 'use strict'; return ${l}; })() }`)(x.module,$)),this.constants=i,this.variables=r,this.children=null,this.parent=t,this.scenarios=h instanceof Object?Object.keys(h).map(e=>({scenario:e,regExp:new RegExp(h[e]||"^$")})):[{scenario:h,regExp:new RegExp(`^${h}$`)}],s&&(S([a+`The router's "children" field should be "array" instead of "%o"`,s],Array.isArray(s)),this.children=s.map(e=>new c(e,this))),this.tailable=o||!(this.children||[]).length,y(a+"✅ resolved the "+(this.path?`router with path "${this.path}"`:"root router"))}match(t,i,r,s=r.length,n=0){var e=this.scenarios.length;if(e<=s&&this.scenarios.every(({scenario:e,regExp:t},s)=>{s=r[n+s];if(t.test(s))return i[e]=s,!0}))return n+=e,(Object.is(s,n)&&this.tailable||(this.children||[]).find(e=>e.match(t,i,r,s,n)))&&t.push(this)}})=>{s=(e,t)=>{function s(...e){return e=i.apply(this,e),this[M]&&this[M].forEach(e=>e.dispatch()),e}const i=(e||{})[t];S([`"${t}" is not a valid method name of prototype object "%o"`,e],i&&i instanceof Function);Reflect.defineProperty(s,"name",{configurable:!0,value:t}),Reflect.defineProperty(e,t,{get:()=>s})};var s,e=(t,e)=>{S(['The 1st argument of "$dagger.register" should be valid "object" instead of "%o"',t],t instanceof Object),S(['The 2nd argument of "$dagger.register" should be "string array" instead of "%o"',e],Array.isArray(e)&&e.every(e=>U(e))),k(e,e=>s(t.prototype,e))};N("click",window,e=>{let t=e.target;for(;t&&!["A","AREA"].includes(t.tagName);)t=t.parentNode;var s;t&&t.hasAttribute("href")&&((s=t.getAttribute("href").trim()).startsWith("#")&&r(s.substring(1),e)||s&&!z.test(s)&&(e.preventDefault(),history.pushState(null,"",s)))},!0);const n={detail:!0},o=new CustomEvent("change",n),h=new CustomEvent("input",n),d=(N("reset",window,()=>e=>Object.is(e.target.tagName,"FORM")&&k(_(document.body,"input, textarea",!0,!0),e=>{e.dispatchEvent(h),e.dispatchEvent(o)})),e(Date,["setDate","setFullYear","setHours","setMilliseconds","setMinutes","setMonth","setSeconds","setTime","setUTCDate","setUTCFullYear","setUTCHours","setUTCMilliseconds","setUTCMinutes","setUTCMonth","setUTCSeconds","setYear"])||e(Map,["set","delete","clear"])||e(Set,["add","delete","clear"])||e(WeakMap,["set","delete"])||e(WeakSet,["add","delete"]),JSON.stringify=te(JSON.stringify),k(["concat","copyWithin","fill","find","findIndex","lastIndexOf","pop","push","reverse","shift","unshift","slice","sort","splice","includes","indexOf","join","keys","entries","values","forEach","filter","flat","flatMap","map","every","some","reduce","reduceRight","toLocaleString","toString","at"],e=>Array.prototype[e]=te(Array.prototype[e])),(e,t)=>{var s=(t||[])[2],i=g.prefix;s&&!s.startsWith(i)&&(t[2]=""+i+s),e.apply(history,t),a()});return history.pushState=(...e)=>d(f,e),history.replaceState=(...e)=>d(t,e),window.$dagger=Object.freeze(Object.assign(C(),{register:e,version:"1.0.0-RC-debug",validator:(t,s,{type:e,assert:i,required:r}={})=>{null!=t&&!Number.isNaN(t)||S([`The data "${s}" should be assigned a valid value instead of "%o" before using`,t],!r),e&&(Array.isArray(e)?S([`The type of data "${s}" should be one of "%o" instead of "%o"`,e,(t.constructor||{}).name],e.some(e=>t instanceof e)):S([`The type of data "${s}" should be "%o" instead of "%o"`,e,(t.constructor||{}).name],t instanceof e)),i&&(i instanceof Function?S(`The assert of "${s}" is falsy`,i(t)):Array.isArray(i)?k(i,e=>{S(`The type of assert should be "function" instead of "${typeof e}"`,e instanceof Function),S(`The assert of "${s}" is falsy`,e(t))}):S(`The type of assert should be "function" or "function array" instead of "${typeof i}"`))}})),([e,t,s])=>{m=e.content;e=new Array(141).fill("%").join("");y(e),y(`꧁ Powered by "🗡️ dagger V${$dagger.version} (https://daggerjs.org)". ꧂`),y(e),S(`The integrity feature is available with "https" protocol or "localhost" host only, while the current origin is "${location.origin}"`,!m.integrity||crypto.subtle),l=t.base;const i=(g=s.content).prefix.trim(),r=Object.is(g.mode,"history"),n=(i?r?(S(`In "history" router mode, it's illegal to use "${i}" as router prefix because it contains non-word character`,/^\w*$/.test(i)),g.prefix=`/${i}/`):(S(`In "hash" router mode, it's illegal to use "${i}" as router prefix because it starts with "@"`,!i.startsWith("@")),g.prefix=`#${i}/`):g.prefix=r?"/":"#",B={$router:null},$=Object.seal(F(B)),Y(t.content),document.documentElement),o=g.routing||{modules:Object.keys(t.content)};u("resolving top level modules"),w=e=>{$=e,u("resolving routers"),b=new c(o),p("resolving routers");e=m.rootSelectors,S(['The "rootSelectors" should be "string array" instead of "%o"',e],Array.isArray(e)&&e.every(U)),k(e,e=>T(`There is no element matching the rootSelector "${e}"`,document.querySelector(e))),e=new Set(e.map(e=>[..._(document,e,!0,!0)]).flat()),T(['❎ It\'s illegal to set "%o" as root node',n],!e.has(n)),e.delete(n),e=[...e];k(e,e=>Reflect.construct(W,[e,x,q,null,!0])),T(['❎ No node with valid directive was detected under root elements "%o"',e],q.length),N("popstate",window,a),history.replaceState(null,"",r?""+location.pathname+location.search+location.hash:location.hash)},(x=new oe({content:t.content,type:P.namespace},l)).resolve(new Set(A(o.modules||[]))).then(()=>E.forEach(e=>e.disabled=!1)||p("resolving top level modules")||new le(new W(n)))}})())))();